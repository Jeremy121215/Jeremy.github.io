<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="logo.png" type="image/png" sizes="32x32">
    <title>æ˜Ÿæ²³éŸ³ä¹ - æ˜Ÿæ²³ä¸ºæ¢¦çš„ç½‘é¡µ</title>
    <style>
        body {
            font-family: "å¾®è½¯é›…é»‘", Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background-color: #f9f9f9;
            color: #333;
        }
        header {
            text-align: center;
            margin: 30px 0;
        }
        h1 {
            color: #8e44ad;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        .subtitle {
            color: #666;
            font-size: 1.1rem;
        }
        .music-container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        .music-header {
            background-color: #8e44ad;
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 20px;
        }
        .music-playlist {
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #eee;
            border-radius: 8px;
        }
        .music-item {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 4px;
        }
        .music-item:hover {
            background-color: #f5f5f5;
            transform: translateX(5px);
        }
        .music-item.active {
            background-color: #e6d7f0;
            color: #8e44ad;
            font-weight: 500;
            border-left: 4px solid #8e44ad;
        }
        .music-controls {
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .control-btn {
            background: none;
            border: none;
            font-size: 1.8rem;
            color: #333;
            cursor: pointer;
            transition: all 0.3s;
            padding: 10px;
            border-radius: 50%;
        }
        .control-btn:hover {
            color: #8e44ad;
            background-color: #f0e6f5;
        }
        .play-pause {
            font-size: 2.5rem;
            color: #8e44ad;
        }
        .play-pause:hover {
            background-color: #e6d7f0;
        }
        .progress-container {
            width: 100%;
            height: 10px;
            background-color: #ddd;
            border-radius: 5px;
            margin: 15px 0;
            cursor: pointer;
            position: relative;
        }
        .progress-bar {
            height: 100%;
            background-color: #8e44ad;
            border-radius: 5px;
            width: 0%;
            transition: width 0.3s;
        }
        .progress-handle {
            position: absolute;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background-color: #8e44ad;
            border-radius: 50%;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .progress-container:hover .progress-handle {
            opacity: 1;
        }
        .time-display {
            display: flex;
            justify-content: space-between;
            font-size: 1rem;
            color: #666;
            padding: 0 5px;
            margin-bottom: 10px;
        }
        .mode-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }
        .mode-btn {
            background: none;
            border: 1px solid #ddd;
            padding: 8px 15px;
            border-radius: 20px;
            color: #666;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.95rem;
        }
        .mode-btn.active {
            background-color: #8e44ad;
            color: white;
            border-color: #8e44ad;
        }
        .mode-btn:hover {
            border-color: #8e44ad;
            color: #8e44ad;
        }
        .back-link {
            display: inline-block;
            margin: 30px 0;
            color: #3498db;
            text-decoration: none;
            font-size: 1.1rem;
        }
        .back-link:hover {
            text-decoration: underline;
        }
        .version-info {
            text-align: center;
            margin: 40px 0 20px;
            color: #666;
            font-size: 0.9rem;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
    </style>
</head>
<body>
    <a href="home.html" class="back-link">â† è¿”å›ä¸»é¡µ</a>

    <header>
        <h1>ğŸµ æ˜Ÿæ²³éŸ³ä¹</h1>
        <p class="subtitle">é«˜å“è´¨åœ¨çº¿éŸ³ä¹æ’­æ”¾å™¨ï¼Œæ”¯æŒå¤šç§æ’­æ”¾æ¨¡å¼ä¸ç²¾å‡†è¿›åº¦æ§åˆ¶</p>
    </header>

    <div class="music-container">
        <div class="music-header">å½“å‰æ’­æ”¾åˆ—è¡¨</div>
        
        <div class="music-playlist" id="musicPlaylist">
            <!-- æ­Œæ›²åˆ—è¡¨å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
        </div>

        <div class="time-display">
            <span id="currentTime">00:00</span>
            <span id="duration">00:00</span>
        </div>

        <div class="progress-container" id="progressContainer">
            <div class="progress-bar" id="progressBar"></div>
            <div class="progress-handle" id="progressHandle"></div>
        </div>

        <div class="music-controls">
            <button class="control-btn" id="prevBtn">â®</button>
            <button class="control-btn play-pause" id="playPauseBtn">â–¶</button>
            <button class="control-btn" id="nextBtn">â¯</button>
        </div>

        <div class="mode-controls">
            <button class="mode-btn" id="repeatBtn">å•æ›²å¾ªç¯</button>
            <button class="mode-btn" id="loopBtn">åˆ—è¡¨å¾ªç¯</button>
            <button class="mode-btn active" id="shuffleBtn">éšæœºæ’­æ”¾</button>
        </div>
    </div>

    <div class="version-info">
        æ’­æ”¾å™¨ç‰ˆæœ¬ï¼šv1.0.0 | æ”¯æŒæ ¼å¼ï¼šMP3 | æœ€åæ›´æ–°ï¼š2025-11-21
    </div>

    <script>
        // éŸ³ä¹æ•°æ®ï¼ˆç¡®ä¿MP3æ–‡ä»¶ä¸music.htmlåŒçº§ï¼‰
        const musicList = [
            { name: "Bubble Beat - Cloud", src: "./Bubble Beat - Cloud.MP3" },
            { name: "Bubble Beat - Sunny", src: "./Bubble Beat - Sunny.MP3" },
            { name: "Dark Code Beat", src: "./Dark Code Beat.MP3" },
            { name: "Lonely Night Veil", src: "./Lonely Night Veil.mp3" },
            { name: "Mint Wave", src: "./Mint Wave.MP3" },
            { name: "Valley's Echo", src: "./Valley's Echo.mp3" },
            { name: "å‡Œäº‘å°‘å¹´è¡Œ", src: "./å‡Œäº‘å°‘å¹´è¡Œ.MP3" },
            { name: "ä¹‰å’Œå›¢è¿›è¡Œæ›²", src: "./ä¹‰å’Œå›¢è¿›è¡Œæ›².MP3" },
            { name: "åŒ—äº¬äº”åäº”æ—¥ (Fifty-five days at Peking)", src: "./åŒ—äº¬äº”åäº”æ—¥ï¼ˆFifty-five days at Peking).MP3" }
        ];

        // å…¨å±€çŠ¶æ€ç®¡ç†
        let currentIndex = 0;
        let isPlaying = false;
        let playMode = "shuffle"; // repeat:å•æ›²å¾ªç¯, loop:åˆ—è¡¨å¾ªç¯, shuffle:éšæœºæ’­æ”¾
        let audio = new Audio();
        let randomList = [...Array(musicList.length).keys()]; // éšæœºæ’­æ”¾åºåˆ—
        let isDragging = false; // è¿›åº¦æ¡æ‹–åŠ¨çŠ¶æ€

        // DOMå…ƒç´ ç¼“å­˜
        const dom = {
            musicPlaylist: document.getElementById('musicPlaylist'),
            playPauseBtn: document.getElementById('playPauseBtn'),
            prevBtn: document.getElementById('prevBtn'),
            nextBtn: document.getElementById('nextBtn'),
            progressBar: document.getElementById('progressBar'),
            progressContainer: document.getElementById('progressContainer'),
            progressHandle: document.getElementById('progressHandle'),
            currentTime: document.getElementById('currentTime'),
            duration: document.getElementById('duration'),
            repeatBtn: document.getElementById('repeatBtn'),
            loopBtn: document.getElementById('loopBtn'),
            shuffleBtn: document.getElementById('shuffleBtn')
        };

        // åˆå§‹åŒ–å‡½æ•°
        function init() {
            initMusicList();
            initAudioEvent();
            initControlEvent();
            initProgressEvent();
            initModeEvent();
            loadMusic(currentIndex);
        }

        // åˆå§‹åŒ–æ­Œæ›²åˆ—è¡¨
        function initMusicList() {
            dom.musicPlaylist.innerHTML = '';
            musicList.forEach((music, index) => {
                const item = document.createElement('div');
                item.className = `music-item ${index === currentIndex ? 'active' : ''}`;
                item.dataset.index = index;
                item.textContent = `${index + 1}. ${music.name}`;
                item.addEventListener('click', () => {
                    currentIndex = index;
                    loadMusic(currentIndex);
                    updatePlaylistHighlight();
                });
                dom.musicPlaylist.appendChild(item);
            });
        }

        // åŠ è½½éŸ³ä¹
        function loadMusic(index) {
            const music = musicList[index];
            audio.src = music.src;
            audio.load();
            
            // è‡ªåŠ¨æ’­æ”¾
            audio.play().then(() => {
                isPlaying = true;
                dom.playPauseBtn.textContent = 'âšâš';
            }).catch(err => {
                console.error('æ’­æ”¾å¤±è´¥:', err);
                alert('éŸ³ä¹åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®');
            });
        }

        // æ›´æ–°æ’­æ”¾åˆ—è¡¨é«˜äº®
        function updatePlaylistHighlight() {
            document.querySelectorAll('.music-item').forEach((item, index) => {
                item.className = `music-item ${index === currentIndex ? 'active' : ''}`;
            });
        }

        // æ ¼å¼åŒ–æ—¶é—´ï¼ˆç§’è½¬åˆ†:ç§’ï¼‰
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        // åˆ‡æ¢æ’­æ”¾æ¨¡å¼
        function switchPlayMode(mode) {
            playMode = mode;
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            dom.repeatBtn.classList.remove('active');
            dom.loopBtn.classList.remove('active');
            dom.shuffleBtn.classList.remove('active');
            dom[`${mode}Btn`].classList.add('active');

            // éšæœºæ’­æ”¾æ¨¡å¼åˆå§‹åŒ–éšæœºåºåˆ—
            if (mode === 'shuffle') {
                randomList = [...Array(musicList.length).keys()];
                // ç¡®ä¿å½“å‰æ­Œæ›²åœ¨éšæœºåºåˆ—çš„ç¬¬ä¸€ä¸ªä½ç½®
                const currentPos = randomList.indexOf(currentIndex);
                [randomList[0], randomList[currentPos]] = [randomList[currentPos], randomList[0]];
            }
        }

        // è·å–ä¸‹ä¸€é¦–æ­Œæ›²ç´¢å¼•
        function getNextIndex() {
            switch (playMode) {
                case 'repeat':
                    return currentIndex;
                case 'loop':
                    return (currentIndex + 1) % musicList.length;
                case 'shuffle':
                    return randomList[(randomList.indexOf(currentIndex) + 1) % randomList.length];
                default:
                    return (currentIndex + 1) % musicList.length;
            }
        }

        // è·å–ä¸Šä¸€é¦–æ­Œæ›²ç´¢å¼•
        function getPrevIndex() {
            switch (playMode) {
                case 'repeat':
                    return currentIndex;
                case 'loop':
                    return (currentIndex - 1 + musicList.length) % musicList.length;
                case 'shuffle':
                    const currentPos = randomList.indexOf(currentIndex);
                    return randomList[(currentPos - 1 + randomList.length) % randomList.length];
                default:
                    return (currentIndex - 1 + musicList.length) % musicList.length;
            }
        }

        // åˆå§‹åŒ–éŸ³é¢‘äº‹ä»¶
        function initAudioEvent() {
            // éŸ³ä¹å…ƒæ•°æ®åŠ è½½å®Œæˆï¼ˆè·å–æ€»æ—¶é•¿ï¼‰
            audio.addEventListener('loadedmetadata', () => {
                dom.duration.textContent = formatTime(audio.duration);
            });

            // æ’­æ”¾è¿›åº¦æ›´æ–°
            audio.addEventListener('timeupdate', () => {
                if (!isDragging) {
                    const progress = (audio.currentTime / audio.duration) * 100;
                    dom.progressBar.style.width = `${progress}%`;
                    dom.progressHandle.style.left = `${progress}%`;
                    dom.currentTime.textContent = formatTime(audio.currentTime);
                }
            });

            // éŸ³ä¹æ’­æ”¾ç»“æŸ
            audio.addEventListener('ended', () => {
                currentIndex = getNextIndex();
                loadMusic(currentIndex);
                updatePlaylistHighlight();
            });
        }

        // åˆå§‹åŒ–æ§åˆ¶æŒ‰é’®äº‹ä»¶
        function initControlEvent() {
            // æ’­æ”¾/æš‚åœ
            dom.playPauseBtn.addEventListener('click', () => {
                if (isPlaying) {
                    audio.pause();
                    dom.playPauseBtn.textContent = 'â–¶';
                } else {
                    audio.play();
                    dom.playPauseBtn.textContent = 'âšâš';
                }
                isPlaying = !isPlaying;
            });

            // ä¸Šä¸€é¦–
            dom.prevBtn.addEventListener('click', () => {
                currentIndex = getPrevIndex();
                loadMusic(currentIndex);
                updatePlaylistHighlight();
            });

            // ä¸‹ä¸€é¦–
            dom.nextBtn.addEventListener('click', () => {
                currentIndex = getNextIndex();
                loadMusic(currentIndex);
                updatePlaylistHighlight();
            });
        }

        // åˆå§‹åŒ–è¿›åº¦æ¡äº‹ä»¶
        function initProgressEvent() {
            // ç‚¹å‡»è¿›åº¦æ¡è·³è½¬
            dom.progressContainer.addEventListener('click', (e) => {
                const width = dom.progressContainer.clientWidth;
                const clickX = e.offsetX;
                const progress = (clickX / width) * 100;
                updateProgress(progress);
            });

            // æ‹–åŠ¨è¿›åº¦æ¡å¼€å§‹
            dom.progressHandle.addEventListener('mousedown', () => {
                isDragging = true;
                audio.pause();
            });

            // æ‹–åŠ¨è¿›åº¦æ¡è¿‡ç¨‹
            document.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    const rect = dom.progressContainer.getBoundingClientRect();
                    const clickX = e.clientX - rect.left;
                    let progress = (clickX / rect.width) * 100;
                    // é™åˆ¶è¿›åº¦åœ¨0-100%
                    progress = Math.max(0, Math.min(100, progress));
                    updateProgress(progress);
                }
            });

            // æ‹–åŠ¨è¿›åº¦æ¡ç»“æŸ
            document.addEventListener('mouseup', () => {
                if (isDragging) {
                    isDragging = false;
                    if (isPlaying) {
                        audio.play();
                    }
                }
            });
        }

        // æ›´æ–°è¿›åº¦æ¡
        function updateProgress(progress) {
            dom.progressBar.style.width = `${progress}%`;
            dom.progressHandle.style.left = `${progress}%`;
            const seekTime = (progress / 100) * audio.duration;
            audio.currentTime = seekTime;
            dom.currentTime.textContent = formatTime(audio.currentTime);
        }

        // åˆå§‹åŒ–æ’­æ”¾æ¨¡å¼åˆ‡æ¢äº‹ä»¶
        function initModeEvent() {
            dom.repeatBtn.addEventListener('click', () => switchPlayMode('repeat'));
            dom.loopBtn.addEventListener('click', () => switchPlayMode('loop'));
            dom.shuffleBtn.addEventListener('click', () => switchPlayMode('shuffle'));
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
